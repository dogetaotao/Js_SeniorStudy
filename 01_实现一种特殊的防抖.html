<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<script>

  //创建一种防抖方式，让输出结果如下
  const Fn = () => {
    console.log(1)
  }

  //传统防抖方法+promise实现
  // const debounce = function (fn) {
  //   let timer = null
  //   const debounceFn = function () {
  //     if (timer) {
  //       clearTimeout(timer)
  //     }
  //     new Promise((resolve) => {
  //       resolve()
  //       timer = setTimeout(() => {
  //         fn.apply(this)
  //       }, 0)
  //     }).then(() => {
  //借助Promise.then，把timer变化放入微队列，这样可以保证timer的变化在setTimeOut之前，同步任务之后执行
  //       timer = null
  //     })
  //   }
  //   return debounceFn
  // }

  //不用promise实现
  const debounce = (fn) =>{
    let running = false
    return function (){
      if(running){return}
      running = true
      fn()
      queueMicrotask(() =>{
        running = false //把running的更改放入微队列
      })
    }
  }


  const G = debounce(Fn)


  function A() {
    G()
    G()
    G()
  }

  //输出1
  // A()

  //输出 1 1
  setTimeout(G, 0)
  G()
</script>
</body>
</html>